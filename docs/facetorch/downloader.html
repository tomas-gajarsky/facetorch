<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>facetorch.downloader API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>facetorch.downloader</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="facetorch.downloader.DownloaderGDrive"><code class="flex name class">
<span>class <span class="ident">DownloaderGDrive</span></span>
<span>(</span><span>file_id: str, path_local: str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DownloaderGDrive(base.BaseDownloader):
    def __init__(self, file_id: str, path_local: str):
        &#34;&#34;&#34;Downloader for Google Drive files.

        Args:
            file_id (str): ID of the file hosted on Google Drive.
            path_local (str): The file is downloaded to this local path.
        &#34;&#34;&#34;
        super().__init__(file_id, path_local)

    @Timer(&#34;DownloaderGDrive.run&#34;, &#34;{name}: {milliseconds:.2f} ms&#34;, logger=logger.debug)
    def run(self):
        &#34;&#34;&#34;Downloads a file from Google Drive.&#34;&#34;&#34;
        os.makedirs(os.path.dirname(self.path_local), exist_ok=True)
        url = f&#34;https://drive.google.com/uc?&amp;id={self.file_id}&amp;confirm=t&#34;
        gdown.download(url, output=self.path_local, quiet=False)</code></pre>
</details>
<div class="desc"><p>Downloader for Google Drive files.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>file_id</code></strong> :&ensp;<code>str</code></dt>
<dd>ID of the file hosted on Google Drive.</dd>
<dt><strong><code>path_local</code></strong> :&ensp;<code>str</code></dt>
<dd>The file is downloaded to this local path.</dd>
</dl></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="facetorch.base.BaseDownloader" href="base.html#facetorch.base.BaseDownloader">BaseDownloader</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="facetorch.downloader.DownloaderGDrive.run"><code class="name flex">
<span>def <span class="ident">run</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@Timer(&#34;DownloaderGDrive.run&#34;, &#34;{name}: {milliseconds:.2f} ms&#34;, logger=logger.debug)
def run(self):
    &#34;&#34;&#34;Downloads a file from Google Drive.&#34;&#34;&#34;
    os.makedirs(os.path.dirname(self.path_local), exist_ok=True)
    url = f&#34;https://drive.google.com/uc?&amp;id={self.file_id}&amp;confirm=t&#34;
    gdown.download(url, output=self.path_local, quiet=False)</code></pre>
</details>
<div class="desc"><p>Downloads a file from Google Drive.</p></div>
</dd>
</dl>
</dd>
<dt id="facetorch.downloader.DownloaderHuggingFace"><code class="flex name class">
<span>class <span class="ident">DownloaderHuggingFace</span></span>
<span>(</span><span>file_id: str, path_local: str, repo_id: str = None, filename: str = None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DownloaderHuggingFace(base.BaseDownloader):
    def __init__(self, file_id: str, path_local: str, repo_id: str = None, filename: str = None):
        &#34;&#34;&#34;Downloader for HuggingFace Hub files.
        
        This downloader retrieves model files from the HuggingFace Hub, serving as an alternative
        to Google Drive for storing and accessing facetorch models. This allows for better 
        discoverability, versioning, and reliability compared to Google Drive links.

        Args:
            file_id (str): Not directly used for HuggingFace downloads, but kept for API compatibility.
                Can be used as a fallback for repo_id if repo_id is not provided.
            path_local (str): The file is downloaded to this local path.
            repo_id (str, optional): HuggingFace Hub repository ID in the format &#39;username/repo_name&#39;.
                If not provided, attempts to parse from file_id.
            filename (str, optional): Name of the file to download from the repository.
                If not provided, uses the basename from path_local.
        &#34;&#34;&#34;
        super().__init__(file_id, path_local)
        self.repo_id = repo_id if repo_id else file_id
        self.filename = filename if filename else os.path.basename(path_local)

    @Timer(&#34;DownloaderHuggingFace.run&#34;, &#34;{name}: {milliseconds:.2f} ms&#34;, logger=logger.debug)
    def run(self):
        &#34;&#34;&#34;Downloads a file from HuggingFace Hub.
        
        This method:
        1. Creates the necessary directory structure
        2. Downloads the specified file from HuggingFace Hub
        3. Ensures the file is saved with the correct name at the specified path
        
        If the download fails, an informative error message is printed.
        &#34;&#34;&#34;
        try:
            os.makedirs(os.path.dirname(self.path_local), exist_ok=True)
            
            # Download the file from HuggingFace Hub
            downloaded_path = hf_hub_download(
                repo_id=self.repo_id,
                filename=self.filename,
                local_dir=os.path.dirname(self.path_local)
            )
            
            # Ensure the file is at the exact path specified in path_local
            if downloaded_path != self.path_local:
                # If HF Hub downloaded to a different path, move/rename it
                if os.path.exists(self.path_local):
                    os.remove(self.path_local)
                os.rename(downloaded_path, self.path_local)
                
            logger.info(f&#34;Successfully downloaded {self.filename} from {self.repo_id}&#34;)
        except Exception as e:
            logger.error(f&#34;Error downloading from HuggingFace Hub: {e}&#34;)
            raise</code></pre>
</details>
<div class="desc"><p>Downloader for HuggingFace Hub files.</p>
<p>This downloader retrieves model files from the HuggingFace Hub, serving as an alternative
to Google Drive for storing and accessing facetorch models. This allows for better
discoverability, versioning, and reliability compared to Google Drive links.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>file_id</code></strong> :&ensp;<code>str</code></dt>
<dd>Not directly used for HuggingFace downloads, but kept for API compatibility.
Can be used as a fallback for repo_id if repo_id is not provided.</dd>
<dt><strong><code>path_local</code></strong> :&ensp;<code>str</code></dt>
<dd>The file is downloaded to this local path.</dd>
<dt><strong><code>repo_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>HuggingFace Hub repository ID in the format 'username/repo_name'.
If not provided, attempts to parse from file_id.</dd>
<dt><strong><code>filename</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Name of the file to download from the repository.
If not provided, uses the basename from path_local.</dd>
</dl></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="facetorch.base.BaseDownloader" href="base.html#facetorch.base.BaseDownloader">BaseDownloader</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="facetorch.downloader.DownloaderHuggingFace.run"><code class="name flex">
<span>def <span class="ident">run</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@Timer(&#34;DownloaderHuggingFace.run&#34;, &#34;{name}: {milliseconds:.2f} ms&#34;, logger=logger.debug)
def run(self):
    &#34;&#34;&#34;Downloads a file from HuggingFace Hub.
    
    This method:
    1. Creates the necessary directory structure
    2. Downloads the specified file from HuggingFace Hub
    3. Ensures the file is saved with the correct name at the specified path
    
    If the download fails, an informative error message is printed.
    &#34;&#34;&#34;
    try:
        os.makedirs(os.path.dirname(self.path_local), exist_ok=True)
        
        # Download the file from HuggingFace Hub
        downloaded_path = hf_hub_download(
            repo_id=self.repo_id,
            filename=self.filename,
            local_dir=os.path.dirname(self.path_local)
        )
        
        # Ensure the file is at the exact path specified in path_local
        if downloaded_path != self.path_local:
            # If HF Hub downloaded to a different path, move/rename it
            if os.path.exists(self.path_local):
                os.remove(self.path_local)
            os.rename(downloaded_path, self.path_local)
            
        logger.info(f&#34;Successfully downloaded {self.filename} from {self.repo_id}&#34;)
    except Exception as e:
        logger.error(f&#34;Error downloading from HuggingFace Hub: {e}&#34;)
        raise</code></pre>
</details>
<div class="desc"><p>Downloads a file from HuggingFace Hub.</p>
<p>This method:
1. Creates the necessary directory structure
2. Downloads the specified file from HuggingFace Hub
3. Ensures the file is saved with the correct name at the specified path</p>
<p>If the download fails, an informative error message is printed.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="facetorch" href="index.html">facetorch</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="facetorch.downloader.DownloaderGDrive" href="#facetorch.downloader.DownloaderGDrive">DownloaderGDrive</a></code></h4>
<ul class="">
<li><code><a title="facetorch.downloader.DownloaderGDrive.run" href="#facetorch.downloader.DownloaderGDrive.run">run</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="facetorch.downloader.DownloaderHuggingFace" href="#facetorch.downloader.DownloaderHuggingFace">DownloaderHuggingFace</a></code></h4>
<ul class="">
<li><code><a title="facetorch.downloader.DownloaderHuggingFace.run" href="#facetorch.downloader.DownloaderHuggingFace.run">run</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
